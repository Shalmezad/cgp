#!/usr/bin/env python3

from cgp.improbed import BrainBuilder, Config
from cgp.problems import IrisProblem, GlassProblem

problem_1 = IrisProblem()
problem_2 = GlassProblem()

config = Config(
    num_inputs=[
        problem_1.numInputs(),
        problem_2.numInputs()
    ],
    num_outputs=[
        problem_1.numOutputs(),
        problem_2.numOutputs()
    ]
)
brain_builder = BrainBuilder(config)
brain = brain_builder.build()

ann = brain.extractANN(0)

for _ in range(2):
    brain = brain.update(True)

# Problem 1:
ann = brain.extractANN(0)
training_in, expected_out = problem_1.trainingSet()
actual_out = ann.forward(training_in)
fitness = problem_1.measureFitness(expected_out, actual_out)
print(fitness)

# Problem 2:
ann = brain.extractANN(1)
training_in, expected_out = problem_2.trainingSet()
actual_out = ann.forward(training_in)
fitness = problem_2.measureFitness(expected_out, actual_out)
print(fitness)
